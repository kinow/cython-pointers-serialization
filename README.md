# Serialize a Python object that uses Cython and pointers

Using pointers in Cython objects and trying to serialize these
objects results in errors such as:

```bash
Traceback (most recent call last):
  File "/home/kinow/Development/python/workspace/serialize-cython-pointers/serialize.py", line 25, in <module>
    main()
  File "/home/kinow/Development/python/workspace/serialize-cython-pointers/serialize.py", line 19, in main
    data = pickle.dumps(td)
ValueError: ctypes objects containing pointers cannot be pickled
```

The example library used here is [`pytdigest`](https://pypi.org/project/pytdigest/),
written with Python and Cython (using pointers). It has a constructor with a
property to define the compression, but no other parameters for the data and
other properties that are calculated when data is given to the object.

This means we are not able to use Python's [`Pickler`](https://docs.python.org/3/library/pickle.html#pickle.Pickler)
and [`Unpickler`](https://docs.python.org/3/library/pickle.html#pickle.Unpickler).
Nor `__getstate__` and `__setstate__` directly in the `TDigest` object of that
library.

The example in this repository uses a *wrapper* object, that wraps a `TDigest`
(full of Cython pointers), and calls the functions of `TDigest` when a user
calls a function. The wrapper implements `__getstate__` and `__setstate__`,
so that when the pickle tries to serialize it, instead of trying to serialize
`TDigest` we return an object with just the minimum data of `TDigest` required
to create a new instance with equivalent data.

This way we are able to serialize and deserialize objects with Cython. There
are multiple ways to implement it, with Pickler objects, with a wrapper as
shown here, or maybe monkey-patching the object, etc.

> NOTE: Serialization is a common part of systems where security issues
>       are found. Remember to read the Python docs and also best practices
>       for data serialization (not only in Python, see Java issues too.)

## Running

Run the `serialize.py` script, it will give you the following output:

```bash
TDigest(mean=-0.00354, weight=1.01e+05, centroids=3527, not merged, compression=1000)
TDigest(mean=-0.00354, weight=1.01e+05, centroids=3527, not merged, compression=1000)
b'ccopy_reg\n_reconstructor\np0\n(c__main__\nPicklableTDigest\np1\nc__builtin__\nobject\np2\nNtp3\nRp4\n(dp5\nVcentroids\np6\ncnumpy.core.multiarray\n_reconstruct\np7\n(cnumpy\nndarray\np8\n(I0\ntp9\nc_codecs\nencode\np10\n(Vb\np11\nVlatin1\np12\ntp13\nRp14\ntp15\nRp16\n(I1\n(I355\nI2\ntp17\ncnumpy\ndtype\np18\n(Vf8\np19\nI00\nI01\ntp20\nRp21\n(I3\nV<\np22\nNNNI-1\nI-1\nI0\ntp23\nbI00\ng10\n(V\xacS-\xf4#\xdbG\xc04\xcb\x8bR7\xfd\xf7?\x05\xa4\x0fL\xc0\x1fE\xc0\x15y\xb8\x07\xf2\x0fC?\x040\xf0\xcep\x9bD\xc0E\xd8\x89\x84\xacl\xc5?Z"\x02\xec\xf6\x81D\xc0\xf1\x8b)\xc9VC\xf6?N\xddfD$MD\xc0\xa5@\xf9\xe8\xb7\x96\xdf?\x06\xcad\xa4\xb0\xe9C\xc0\\u005c\x9fT\xc9\x89\xe6\xf0?\xd4Eb\x11\xd8\xd3C\xc0F\x90\x86\xa6g\xac\xb5?\xf1\xe31\xa6\xed\xabC\xc0hJ\xeb_90\xe1?\xc6g\x15\xa8u(C\xc0\x84D>\xcb\x8cD\xdb?\xb2\xd7\\u005c\xd5\xc8uB\xc0Y\xa0\xe8\x95\xfc\xd0\xd3?\xe9\x92\xbae\xf2OB\xc05\x98\x84Ak\xfc\xd9?\x88^\xa1\xfe\xfd4B\xc0\xe9J\xf5\xf5xT\xd0?\xbaHu\xfe<\x08B\xc0W\xa0\x16\xb5\xf3\xf4\t@h!\x91\x9e\xdd\xf4A\xc0y\x9a9\xb4\x03g\xea?(\xf9}U\xb4\xf2A\xc0\x86\xf5\xc5\x06\xf0\xe9\xdd?K|\xe4\x9a\x84\xefA\xc0~\xe3\x9d\xe3\x0f\x08\xf6?\xc9\x94\x9d\x9b\x84\xccA\xc0\xb5o `B\x9c\x03@>\xa7\x87\x8f\xbc\xbfA\xc0F\xd4\xdd(\xb0=\\u0000@I\xad\x87\xf5+\x8cA\xc0Bi\xee\xc3Q\xd9\x01@\xe0\x89\x04\x8bm\x8bA\xc0\xc8\x11\x071b\x92\x07@#\xdeKf{|A\xc0\x08\x94\'\x9a\xee\x98\xf1?\xf7\xe7\xc9\xf9\xc9xA\xc02XZM\xe3\x8d\xe4?\xd4\x8e\xc1}_qA\xc0\xcf\xbe\xaf\x9a\xa8:\xf2?7\xeaz\xee-iA\xc0:\xa6\x07\x9e\xdf\x11\xef?\xa3\x83}V)DA\xc0\xdcv\xa2\xfa:\xaa\\u000d@wI\xe1\xde|\x1eA\xc0\xf2\x95o\x8a\xb8\xd6\xff?0\x1e\xd2B^\xea@\xc0\xee\xee\xa0\x1e\xc1B\xfd?\xf8Z\x8b\xfc\x98\xd2@\xc0\xa47\\u0000\xff\x8a\x90\x01@Z\\u000d\x1b\x8a^\xbd@\xc0\x02\xdfB\x15\x10\xac\xf9?$b\xba\x96\xe4\xb2@\xc0\x8c\x92\xfc\x8fU*\x0e@\x95\xae\x81\x8f\xd5\xae@\xc0\xcf\xd4\x0b\x92!\t\xfc?\x1f\xd9\x94\x0b\x87\xad@\xc0\xdet\xcd\xeaF\xa2\x01@`\xad\xfc:3\xa7@\xc0Ji\x10<\x84\xea\x01@\xb7\xaa\xbdE\x9a\x91@\xc0,\x01\xe7G\xf9h\x07@\xb8M\xc4\xecFd@\xc0d\xe6h]:^\x02@\xe4Y\x01\xd2bb@\xc0Jo\xbdK\xa2\x08\x05@\xfc\x86Q\xb2\xbbZ@\xc0\xc0\xe1T\xf3#(\t@\x8f\xbcM\xc4\x11J@\xc0x\xbaU\xb9J\xb9\x10@\x8b\x94\xa7\xa19&@\xc0tU\xa0\xa0\xf1y\x0f@\x84&ou\x07\x10@\xc0\xdb\xb7\xde\xd6\xdb6\xfe?\xb0\xd5\\u001a,^\xca?\xc0\xfb:\xd3\xc6\xfaE\x0f@\x8ch\xdc\xb2\xee\x87?\xc00h?\x1f\x1c\xf8\x0f@\xeb\x1b\xcc2\xc7]?\xc0\x88V\xfeA\xba\xd1\x0f@\x8e.0;\xcc)?\xc0\xf5\\u000a\x8c\x8e\x1f\xa0\\u000d@\xefB1p\xd2\x18?\xc0D\x99\xfc/\xedx\x08@\xa2Y\xfe\x1d>\xf9>\xc0@o\x8ci{\x8b\x11@xJwsq\xd5>\xc0\xb7\\u000d\xac\xe3\x03\xe3\x11@\\u005c\x17y\\u000a\xed\xc6>\xc0U\xf6b\xe1T\xb4\x18@\x83\xf0\xb1#Qw>\xc0\x88E\xb47\xcc\xd8\xff?!\xfd\x07G\xe5[>\xc0\xc0\xee\x84\x82\xfby\x1b@H\x9e\x80(\xde)>\xc0\x02\x82\xba\xc1\xdc\xcf\x15@\xd8\xa33\xc9\xc7\x0b>\xc0\x0c\xca4\x05\x10`\x1f@\x12\'`\xe3T\xfb=\xc0\xf9\xd2~M\x13\xcb\x13@i\xe5\x94\xad5\xeb=\xc0\x06;\xb41\x94@ @I\x9fr\xec\x97\xce=\xc0\x9d\x14\xc4\xc7\xd9\x91!@Q\xe0\xfc\x05Q\x9e=\xc0\x8e\x94_\x9cB\x9c"@\x9d"^\x02UV=\xc0vP\x08\xb7\xb1\x8a @\x1c\x1f\xc7\x9a\x1b6=\xc0\xfbN[v\xd0O#@y\x8c\xd7q\xbe\x18=\xc0\x13\xe5\xc0\x9a5\xfc @\xaa\xe0\xa9e\\u005c\xf9<\xc0 \xeb\x19\x8bK\x02(@\x111\xb8\xba\\u001a\xdc<\xc0\x83\x7f\x9b\x0c\x03o%@K\\u001a\x9ac\x06\xc5<\xc0\x9e\xd93w\x16\xe0\\u001a@\xa9\x0f\xed\xe8\x1c\x8a<\xc0b\xb3\xf9C]=*@\xf6v/8\\u005cF<\xc0\xac\xeb\xc4n\xe1\xee-@\xea\x94(\x86\xd2\x16<\xc0j]\x18\x8cn\x87)@r\\u000d\x8e\xb51\xe2;\xc0\xb9\xb0\x1f\x9ep\x18(@\xd8\xeb%-J\xa7;\xc0\xbc\xa7\xc1\xca,\x8f.@\xf9\\u005c\xa6\xff\xeb\x80;\xc0\x8c\xff\xaa?\xa3\xdb1@\x7f\xaf\xca\xd6\xb5N;\xc0G\\u000d\xc3\xca\xd9i0@\xc2y+R\xab\x1f;\xc0@@\x15\xd9\x92\x151@D\x0e\xa91\xda\xf5:\xc0\xe6Z\xec\xd8\x01\xc24@@\xea\x1c\xe7\x88\xdd:\xc0\\u001a\xd7\x84\x02-v7@M\xe0 G\xde\x9f:\xc0\x03\xb1\x1cm\xcd\x159@@\xff\x11G\x80]:\xc0\x19\xfa+\x9d\xe7\xcc7@v1\xde+\\u000d :\xc0<4\xe98\x98\xa5;@\xd8\xa6\xd5\x8f\x06\xde9\xc0\xa2\xdbB\xba\xe1)?@\x13Rm\x9b\xf8\xa89\xc0@\x95S\x97\xc2\\u000d>@\x1f\xda\x17\xe5Km9\xc0GH\'\xb8\x12\x97<@K\x1e\\u000a\xe7\xe7A9\xc0\xde\xc5\xb8Yj1B@+\x97\x84\xb6\xc8\\u00009\xc0fzdO\xc0#9@\x9d\x08\xb1\xde\x98\xd38\xc0\x7f\xd9\x90\x95\xffT8@n\xef\x18I\x8c\xab8\xc0!\xd9\xba\xda\x8f\x18?@\x0cNYPn\x968\xc07\x15\xd8u\xd8&2@]\xccx\x0e\x8dr8\xc0\xb8g\xa9;\xcb\x12C@\xa5\x1bb\xddG88\xc0h\xd7\xfaM\x89\'I@\\u0000m\xaa\xa26\xf97\xc0\xa3\x8fb0\xe7@K@\x8e\xd2\xaea<\xce7\xc0G\x01\xc0\xecI\x81;@\xbb\x8eW\x9e\x95\xa47\xc0\\u005c\x87\x11{\xdc\xc5H@I\x95\xb2\t1r7\xc0y\x07\x99C\xacHG@E<\xc2\xbb\x16=7\xc0\x93\\u001a0\x18\xeaLI@\xd7J\x93\xe3\x8c\xef6\xc04\xbc\xc1\x98\xa0\xbfP@=\xcf\xc7{D\xb26\xc0\xc8m\'\xff\x05\xcdQ@\xfb\x10\x1ep\\u005c\x876\xc0\xc5w\x0b/\'\xc6F@\xf8|\xb1\xc70]6\xc0\xc1h6\xff\xa5\x81P@\xe3\x91\\u0000\xa8N:6\xc0\xd2YX\xbfjHP@\x14&.}q\x106\xc0\x15\xc1\xe0\xd4\xca\xaaP@\x14\xc1M\x1e\xfb\xe15\xc0\xf9\x9dF4\xdcME@\x05\x90\xed\x80\xa4\xb85\xc0\xbb\x92M#gGS@\xf89\xbd\xe5\\u005c\x805\xc0\xb4^{_\x13*U@w\xd7v\x8c\\u0000P5\xc0\x93\x12\xf2\x9f\xbe\x0cU@\xd9\xf5x\xf7\x18"5\xc0%\\u000a\x16\xf5a\xcfV@=\xbb\xfe$)\xed4\xc0e\xc4\xd3,5\xe1Q@N\x86mX\x9d\xae4\xc0\tXQ\\u001a\x90\xf5Z@\xa1j\t\xcb~o4\xc0\xad\x9f\x14\xc6\x9e\xa4`@p\x16^t>)4\xc0^k\x85/\xf3\x10a@\xa5=\'\xd6\xff\xf43\xc0b\xd6\x9cU\x1e\x0fZ@<\xf8\xa0\xff\xdf\xb83\xc0\xac@n\x97\x8a\x8a`@\xff#\xa5\xcd\xec\x873\xc0\x1e3\xf3\xf9\xc9n[@%\xbc\xc1\xb1,T3\xc0\xc53\x92R\xd7\x8e\\u005c@\xd8{\x98\xe2\xfd\'3\xc0\xad\xa3.\xf8\x1e\x9a\\u005c@\xd8$E7\xf0\xee2\xc0SO\x95\xb3\xb58c@$X\xaej\xe8\xb92\xc0\xf4g\xc1{~Hb@ML\xf6\xcdF\x842\xc0y\xf3\x1c1\xdfhc@\xc5\xd7)*QR2\xc0\xd5|\xea\x7f\xb2\xb1a@\x8b\xdd\xce\x9a%\x1e2\xc0,\xbfV\xb9\x85\\u005c_@0\x88\x85\x10m\xf31\xc0\\u000a\xb1\x8e\x02\x85ud@\xd1\x9c\x96\xc56\xc31\xc0\xaa\xd7${\x15gg@kQ\xce\x01g\x8b1\xc0+6Z\x1ez>k@sA\x1fboJ1\xc0E\x02\x0fn\xb1\xa5m@\xe6\xf5\xdbC\xeb\x011\xc0\x86\x8fI\xd1_\x91n@\x15\x95\xcd\xa0w\xba0\xc0\x13\x993\x1e>\xdao@\xd2\x08\xb5\xbc\x8aw0\xc02\x12\xbe1\x8a\xcdo@o\x8em\x97\x8c80\xc0\xf7\xccD\x13g\xedm@\xed/\xe4v\x05\x010\xc0|;\xa3\xb3q\xaem@\x15-t\xe4\\u000a\x83/\xc0#\x95"\'\x99$s@\xf7\x13\x1e\xfe)\x08/\xc09\xe8\xc4c1\xc9s@Rw\xd8\x9c\x96\x97.\xc0MI\xd7u9Xq@`\xb7uD\xcb!.\xc0m\xd55\xe8\x0e\xf0m@\x0f\xa4\x906\xca\xb0-\xc0\xa4E\xc9\x97@\xbat@\x93M\xc4,\xcf)-\xc0\xf6\xc9\xf77\xe6Cz@\\u000a\x86\xcc~3\xa0,\xc0\x90\xed\x07l\x88\x04v@\xdf\xb0\xf7\xb1\x9f1,\xc0\x1b\xc3\\u0000\tfFv@[\xe4\xf8F}\xaa+\xc0<\xc8N\\u0000Cyz@\xa9\x7f\x8eB\xc3%+\xc0\x82\xa3Z\xe7\xae\xe8\x7f@SZN\xfbS\x9a*\xc0)/1\x04\x08\x14|@\xbe\x99\x882[\x10*\xc0\xe1U\x95\x93iKz@\xa3\xbb(\x0f\xb9\x97)\xc0\x93\xcc\xa72\t\xf4{@\xfef+\x8a\x87\x13)\xc0\xb9o%\x04\xef\xb1{@\xd1\xf2i\xe0\x93\x94(\xc0u*E\xf6\x03\xe7}@l\x81|\xbcL (\xc0%\x82\xb5\xb0aEx@w\xb0!\x15\xa3\xa9\'\xc0Y\xaf\xcaD\xd1^}@:\x1b\xbd\xf76(\'\xc0\ts\xaa\xe6\xc7\xc9\x80@d\x12-\xbd\xe2\xa2&\xc0:\x15\xda\x1b\x0c\x16\x80@v\xbd\x1d\xc0\xf4%&\xc03\x1flI+\xa0\x80@\x80\xbeG\xee\xd4\xab%\xc0h\xea\x9fI1\xaf\x80@]\xf3\tYL/%\xc0\xbd\xb7\xc5\\u0000\xd9\xdc\x80@U\xf9`\xf8\xb0\xa9$\xc0}wE\xd9\xae\xc8\x84@\xdbyu\xc0\x17#$\xc0\x1b\x1c.\xe1z\xca\x83@\xfa\xea\xff\x88p\x9e#\xc0\x03\x85\xf5G9\x01\x85@\xb4\xaa,<\xb6\x1d#\xc0\xe9\x93\xf0\xd6\xd2B\x83@s\x07\xcfbs\x8d"\xc0&gu?\x04E\x85@\xf9U\x0c7\xa7\xf4!\xc09nf\x9cK\x83\x8a@\xf7\xec\x90\xfd\\u001aM!\xc0\x01\x02f;\xf6\x14\x8b@\x1c\x05\x17:.\xae \xc0\x04#M\xdf\x86@\x8e@0\xaaa\xe4\x0c\x0b \xc02\x8e9o\x19C\x8c@~!\x97Bh\xe9\x1e\xc0\xbd\x8b\x12p\x1d!\x8b@T\x99\xe1v6\xbf\x1d\xc08\x06\xd3\xaf\x91P\x89@\xfd\x05\x93\x9f\x0f\x8f\x1c\xc0f\x14\xb4\xb6v\xf3\x8b@\\u005c]C)\x02c\x1b\xc0~\xf5\x9fL\xf3\xe5\x8f@\xd3K\xfc\xeb\x90\x17\\u001a\xc0P\x84\xf6\xf9\xb4Y\x8f@\xca\xdf\xfc\x80\xcc\xc3\x18\xc0=a\x07,\xd6\x8f\x92@Wi\xbf\xa1\xe4`\x17\xc0\\u001a\x06\x063&\xc8\x91@"Nf\xad\xfc\xfe\x15\xc0\xa3i\x95\xcb\xb7c\x93@\xbe4\x15p\xc2\xa0\x14\xc0\xea\x99Q\x15\xbaS\x94@\x9d\xb5\xbf\xa20G\x13\xc0\x98\xb5\xb8w\x9b\xc8\x92@B\xeaR\xd3B\xf6\x11\xc0@S\x14E7R\x90@\xad\x96\\u001ao\x0f\xb6\x10\xc0\x98\xca\xd5r\xc5\'\x94@=,\x10\x11\xd6\xb8\x0e\xc0\xd1l\xb0\x9d\t\x81\x94@\x0c^\xf4\xd0\xaf\xe2\x0b\xc0\xe0\x9c\xf0\xf5\xe2E\x94@D\x16\xba\x97\xb2D\t\xc0h=)\xad\x07.\x93@\xccC\\u005c\xc6B\xc8\x06\xc0@\xba\xbb\xa5;x\x91@\xfc@\xcf\x8f\xe8m\x04\xc0\x87X\xeb\x159c\x92@\x85\x8dG\xfc\xf3\xf5\x01\xc0\x1f\xd0\xc5]\x16\x8a\x93@\xf2C)^\xb5\xc3\xfe\xbf\xdb\x8e\xd1\x86\xe8d\x95@\x8b\xc4\xdd\xe0\x1d2\xf9\xbf]<\xf0\x96\xbas\x95@\xf1]|\xb7\xaf\xa0\xf3\xbf\x18\xc0\x94\xcf\x1e\xf7\x94@\xee\x0b}l\xc2\xf6\xec\xbf\xc3\x8e\xc4\x9bwr\x96@C\xdc\x80\x7f\x10`\xe2\xbf\x84\xdf\x8a,J\xfe\x92@\x03G?\\u000a\x17\x0e\xd0\xbfA\xe5\xb0\xf4=a\x92@\x94D\x7fW\xa0\xaa\xac?%<\xa4\x7f\xc8\xe1\x93@1\x8e;\x1b\x98\xe6\xd6?\xcb\xc3/\xa0&\xf3\x93@,\xd6\tD_\xa3\xe5?\xb0\x84paL\xc9\x95@\x81K\xca)R&\xf0?e\xe5\xa3\x10\xb3\xd8\x94@K\xfa\xd9M\xe6=\xf5?\xc3\x82\xf7a>]\x92@\xae\xec\xf3\xec\xcc\xfd\xf9?D\x115\xf9qx\x92@C\x9d\x9d\xbd\\u000d\xdd\xfe?j\\u000a\xb8nk\xad\x92@\xed\xca\x7f!\xcc\x1f\x02@\xe4N>I\xed\xf3\x93@Dd\xfc\x04q\xfc\x04@\x15&\xc3\x83\xaf\xa3\x96@k\\u0000y\xd5\x1e\\u000a\x08@\x99\xfc\x1e\xda\x93\x1b\x96@\xc3\\u005c\x10\x16\x12\x18\x0b@\xec\xb9`\xcf\xc4\x9d\x96@\xdb\xbd|\x7fC\xb8\\u000d@\xee\xb8\xa6\\u005c\x882\x94@n\xd1\x0bM49\x10@\xf9spv/\xf0\x92@H\x85\xc4\xc6"\x8f\x11@\xbagpk)\xfe\x90@\x85\xc9\xc8\x0b\xe6\xd1\x12@\xdd\xf9\x0b.\xe2\xa1\x90@\x07\te\xd7\xcb\x02\x14@\xf4\xa6\\u000d\xfdd \x91@V\xb9\t\xdd/B\x15@\xbe2P\xb7\xff\x99\x91@>K"\xdb@\x80\x16@\x17\xdc\xd0\x0c\x16\xbb\x8f@\xae\xa1\xa8\xe5v\xac\x17@\x80\\u000d\xb9\x9b&\xd5\x8d@\x11\xf7F\xe4\xad\xd1\x18@\xc6A\xca\x94\xd7>\x8c@&\x84\xb4\xe93\xfa\x19@\xdd\xbc\x8f+\xc5\xe2\x8f@\x07G\x97\xffj/\x1b@\xd4\xf9\x89\x1bd\xf2\x8f@\xcd3\x07\xd5Ri\x1c@\xe4\xeeM\xaa\x97\xf0\x8f@\x96(xX\xc4\xaf\x1d@A\xec\xf1\xbc:\x86\x8b@Gi\xebf^\xcd\x1e@Q\x11\xc9\x05\xa6\xbd\x8a@4\xc2\x88\xcb\x19\x02 @U\xb7\xb7\x9d\xfb\xc1\x8c@,9\xa8\xdb\xa5\xa2 @\xea*) \x9c\x10\x8d@\x9f\xaf\x0c\x10\xfe;!@\xa5M\xfe\xa29l\x89@f\xea*\x95\xec\xd9!@\xfc\x16\xc6\x9a\xe1W\x89@\xbd\xf6\x95\x93.n"@\xfe\xdc\\u001a\xeb\x9c\xc6\x86@\x93_m\xd3\xdd\xff"@\x84N\\u005c!\x07\x18\x85@\xacS\xa3\xe3\xba\x8d#@0\xfd\x0f\x8f\x99\x06\x85@\xb8\xd8!`\\u0000\x1b$@\xc5\xf0/\xa0\xb7\xc7\x85@\\u005c\xa8v%h\xa2$@\x07^\xdc\xec\x81U\x84@\xb4\x0fh\xecR9%@\x1d\x82\xb7\x8f\xdaN\x87@2\x8f\xef@\x99\xf3%@n\xdb\xbd\xcfS\xff\x89@\x97\xe2\x06&\x18\x97&@\xff\x1dv\xd3\xc1\x17\x86@\xf1\xce\xf8\xfen>\'@ml\xd2\xd62T\x84@"\xb3\x18\xbb!\xe8\'@\xc82\x1cGQ!\x84@w8\xc3\xe3\xcax(@@F\xccVj\xbe\x80@\x80\\u001at\xec\xcb\xfd(@;\x01\x12\xeaX\xce|@\xed\xe6q\x9d\x92\x82)@^\x02\xa8\xb8\x08x~@?W\x08A\xd4\\u001a*@\xd5\xd7\xd8\xedp\xdc~@\xac\xff\xf5 \xf1\xa7*@\x8f\x92\x05\xf0\x01\xa6{@\xd6\xf9\xbcHR3+@\x99\xc2\xda\x99\x0f\xdez@5\xa8\xb2\x03\xb4\xc8+@%\xb5\xd5\xafN\xd5y@\x88\xe2x\x96\xfb`,@\xee\x17y\x8d\x80\x8ey@\x88\xfc|\xfe\x89\xf8,@S\xaa\xd5\xda\xdd\x8eq@\xf1!\xef\xc7\xbei-@\xf07QqF\xa7v@\xb7\xac\xa8\xc9A\xf3-@\\u005cw\xf1\x8a\x113s@\x9a\x16\x97\x9b\x96p.@\x815R\x85\x1c\xb5s@\xca\xab\xb4(\xe3\xef.@\xc7\x9b\x08u\xac\x02r@\xb5\xe5-\xe6~]/@>N?\x14\xd78o@\x96U\xeah9\xc7/@\xfd%g\x80\xa7\x87j@{\xed\xe6&?\x190@\x8dHd\x06\xd8\x98n@\x9e\x19B\xe2\xb5I0@*T\xfe\x18\x8f\x8fh@\xd2\x1e\xad\x0f\xa8w0@Z\xc1\x86u\xd4\xf1f@<\xd9\xd2hB\xad0@\xaa\xcc\xe7\x9d\x8aGk@\xfbJ\xfb\x84|\xe90@\xe1ejxt8o@\x89N\xd6\x0f\x1b\'1@\x0bNC\xbd,\xb9n@\xcd_\xa0/\xce_1@\xa8\x13\xdc\xdd\x13\xa2n@C\'\xce*7\xa11@,]\xd7\x0bf\x8fk@\xc4\xb6\x06-n\xdd1@\x99\xc8\x02\xc2\x87Tf@\xa6\x89J:\xec\x112@\x9a\xdd\xb3\xa24\x17d@\\u000d\x94.kQO2@W\xef9\xf9\x90\x19e@\x04N\xb41]\x8d2@m\xb3C\xa0\xa3\x85c@\xd7Y\xdb\\u000a\xd3\xcf2@X\xa0\xd1\x08%\x8cf@\xfe\x8b\xf4\xa0.\x083@\x92\x02ja\x90<b@\xb3\xfc:\xeb"93@\xb0S\xb4\xaf\x88\xcb_@z\xad\xf0\x06!o3@\xe8\xaeI\xf2\xa9\xd0T@\xe9\x8d\x8c\x8b\x95\x9d3@g\xa7\x83\x1f\xddv[@-\\u001a+\xa4\xdf\xdc3@9\xac5]k\xa7a@\\u000a\xa3\x87\'\xdb 4@\x958\x81\xb6\x95\xab\\u005c@\x94O\xebW\x1bW4@\x89\x07\xb4FzfT@\xb2\x82\x1bg~\x8c4@\x11\x83\xd1\xb8\xa8YX@=\xa1o\x89\x8c\xc94@q\xed+\xdf:NY@\xeb\xb6f8=\xfa4@\xa4Z@\xf5=zW@s\xab\x8c \x06+5@\xe6m\xf5\xbe\xcf[O@\xc2;)\xbc\x19[5@\xcb\xccn\x8a\x1d*Y@\x8e2\xea[\x97\x9d5@U\x061\x1d\x84\xe1W@V\x85d8\x98\xd15@\xae\xff\xe0\xfa\xdb\xf9Q@\xf2>\x1b\xc4\xf0\x106@`\xff>\xcd\xe7&W@\xa4\\u005c\x02!7Q6@\x14\x83\xddkc\x91U@\x83j\\u000d\\u000dI\x956@\x88\xfd\xd7\xb9\xb8\xb6M@F\xb6\xa0>\xa5\xd46@\x03\xd0\x07C\x19\xdeP@\x97\\u0000U\x94\xaa\\u000a7@\xfe^5\xf9\xe7\x89O@]J\xbf\x82q>7@\x08%d\xb78)K@\xaa[\xbb\xb9_k7@\xe0$\x11\xda\x92\xe9I@\xf2y\xc4\xde\xd7\x967@\xec5\xc9\x8b\xef\xb3E@\x82i\x9f\xa2m\xc07@~\xe5\xa2\x05\\u005c\x87I@x(\x8b\x19\x18\xf87@\xf3\xf8G\xeb\x0f\xecG@\xbdY1\x85K;8@\xbc\x0e\x10\xf9\xb3|D@)\xe3\xb9-9q8@H\\u005c\x1f\xf7f\x87F@\xf6\xf4D\xe3\xf3\x948@\xfb_\x17\xea\xe8+I@\xe1s\xc9&\x1c\xc68@@f*\xd2\xa7\xa7A@\xb0\xf9e\x8e\xda\xe78@G\xda\xdf$l\xd7:@K\x9c\xb8_$\x169@\xd8\xb5\xdb\x1e\x92>@@\xf5\xda\xc4\xd5\x9bQ9@\x07\xca\x02\xf9\x1b\x10B@\x1epm0zy9@\xc5\x9d\x8d\xc8\x16aA@\xae\\u0000e\xb1\xd0\xb19@\xa3\xaf\xee\xa2\xb4\xee9@r6\x12\xee3\xe19@\xff\x95\xde\xc2\xd8|9@_\xce:B\xb1\\u000a:@H\xe6\xc4\x1e-m>@\x1em\xf2A\xad6:@\xc1\xee\xeb\xc7\'d4@\xdf\xe2E\xdbw[:@\\u000a{\xec^\xba[4@\xf1\xfaO\xbe\x8a\x83:@\x17_A\xc89\xdd2@\x99+\\u0000\\u000d\x96\x98:@\\u0000\'/\x12z\xe56@\xd8\xf6\\u0000\xb1\xd8\xc4:@\x9c\xac\x053\x84h\'@\xc1#\xfa\x9b\xee\xee:@\xa5\xc7\xf6q\xf3\xc91@,X\xe6\xc0h);@k\xafq\xe7\x0c\xaa0@\xb1\xb0\xb9\x96\xbbR;@\x1e\xc1\x88-\xb7\x980@;\x15P\xdf[{;@\x8fe\xf7\x9c\\u001a\xc2,@\xebCf\xb0C\x99;@\xa9;\x14\x88\xcc0$@&\xc3\xb6]p\xb4;@Sz\xfdR\xde\x1f0@G\'\x9b(\xd0\xde;@\x7f\xa9\\u001a\xd4]y)@\xde1\xaa\xb5\x0c\xff;@e-\xa2K\xab!(@@\xec\xf0]\xa0\x1c<@\xb6\x9d\xd8\xc2\x9d\xdd,@\xfc\x8f:4)P<@*\x9c\x97\xdf\x10\xb3*@\x83\xc6d\x81Ps<@\xd0\xf7\xf6/\x83\xa9\'@yC\xdf\xa5d\x99<@\\u005c\xb8\xe2e\xbea,@19\'{J\xb2<@\tBq-^J#@\x86#6}\xc4\xe9<@\xceU\x15P\xe1\xa8"@J\xd8t\x19p,=@\x84\xbd\xd8\xdc\x93))@\'\xb2\'\x94mn=@|W\xfe\xff6\xda!@d\x8e:\x7f4\x9c=@\x179\xc59\xbd\xee\x18@\x14\x12\x14\xa2\x8b\xcb=@\x89K\xa1!\xe4\xcd\x18@``W\xaa\xdd\xfa=@G\xfe\xa5Y\x86\x81\x19@GV\xdc\xe1K\x02>@\x84\xd6\xc4O\xf0\xe0\x1b@\xce\xbb\xdc\xd9\xb4+>@\x1f\xb8\x89\x95 w"@\xf5u\xf8UVI>@\xa2\x8b\xc4qJ\xf8\x1b@f\xf7\x7f\xc3Fr>@mV\xd2\x17\t\x07\x1d@\xb1\xb2\x15\xe2\xfd\x9b>@\\u0000|\x91\'\xb3\x14\x1b@Q\xf7y\x85\x0e\xd8>@F\x16\xceyta\x13@\\u0000K\xf6l\x84\x15?@ER\x994M@\x0f@\xf8\x9eME[6?@\x8a\xa3\x1c\xd3\x7f\xcf\x16@P^\x03\xe7\x85B?@\xa6\xe1\xa1\xb05\xfc\x16@\xec\x06\xb9\xadsy?@%\xb1<l\x0f\xe2\x10@\x1c\x1d\x97\x90q\x98?@8\x10\x04\xb9\xf7\xa3\x10@X\xffB^\x0e\xad?@\x98,\x87\x01T*\x0c@\xe6\xc8\xe0\xe0\xf4\xea?@\xd8Cw\x10\xb7E\x12@\x0b\xf3%\xad\xb5\x17@@\x9c^\x12\xaa\x9f\xc7\x0f@L\xbe8\x0e4-@@F!ZO\xf4\x86\t@\x81\xc4\x15\xc8z4@@@S_Q\xdc\x04\x07@\x01\x84\xd96\xa7L@@\xa2\xbe\xa8\x1f\x89&\x07@HI\xa1>\xb1P@@T\xc2\xa5\xac$_\x13@<\xe7\x168Pa@@V7\x8a\xe7\x1b\xca\x08@\xd3\xd8gt\xafk@@\x92\xa7\xa3\xf4\x15\xb2\xf5?g\x9c\xc6\xa4\xe2o@@\x93P\xe9\xd8~\xfd\x02@\xf0\xf8\xec\xf3\xe1\x80@@x\xbeL\x7f\xad\xb4\x08@^\x9d@\x04n\x8c@@\xab\xc8L\xcc2I\x01@8nrR\xdd\xa0@@\xdf\x90\xbc\xc0\x87\xc3\xf1?G\x10\xc4\xff\xb4\xad@@\xacz-fvL\x06@\xca9)\x8a1\xcd@@R\x0e~d \xb3\x02@\x9a\xa6\xce\xfd0\xea@@(\t\x14d\xc0\x08\x04@$\x82\xfeF\x8b\xf7@@\x17\xc3\x03\xbcS\xeb\xf8?\xe6\x8d\x99\xae9\xfc@@\xe5\xbf\xe2\xd1%T\xf1?R\x8e\xd3\x02F*A@Ua\xf0\xe6w%\xf6?7\x0e]2SZA@\xc4\xfb\xb3\xff\xcf\xef\xf8?\xf5\xc9\xa7{\xe8\x8dA@r\x9b\xaeo\xea\xad\x01@\xceA\xc9\xab\xa4\x9eA@g\xf1\xc0\xf6q>\xe0?~\x12\xd3\x17\x9b\xa0A@\x0c\xae0&\xed0\xfb?3\\u0000\x8e=_\xbdA@\xb36\xf3f\x1d]\x05@\xa1S\xb1\x83C\x16B@\x9fZ\xc2FR\xf3\xee?/\x1d\xd0\xf5\x11kB@\xb1IV\xfb\xdd\x18\xf5?\xea\x95\x03{\xbf\xaaB@\xe0\x96\xb0\xd7@\xd1\x14@\x83\xa5\x94\xf2\xa7\xc1B@MM\x8c\x8c\x88K\x01@\x84\xa0\xc6Z\xe3\xc2B@\x9b\x8c\xb5f\xc5\xcc\xf0?\x02\x88\x9c\xd2\x10\xc5B@\x9f69\x1e\x99\x99\x03@$\xcbO8:\xd5B@\x03\x1c\x8axrp\xf5?\xe8b\xc4\x9ba\xe6B@G\x94~\\u000a\x86$\xfb?-\xd4\x17\xbe^\x03C@\xd4S0\x9dUj\xcc?\x14\xb8KM\xcb\x0fC@\xb7\xed\xcd\x8d\x7f\x98\xf5?rm\x8cC\x10.C@\x08W\xa2Z\xd4z\xea?\x93F\x8d\x7fT9C@\x8b\x85B4?\xe6\xd3?c.\xbf\x85/tC@\xf8=\\u001a\xef\x03\xa5\xde?\x89\xf9+B\xe4\xc2C@h\xd1F\xf6$\xa8\xc7?\xca\xa5x\x12\x9c\xe0D@\xd6}y~\xees\xfe?\np24\ng12\ntp25\nRp26\ntp27\nbsVcompression\np28\nI1000\nsb.'
TDigest(mean=-0.00354, weight=1.01e+05, centroids=355, merged, compression=1000)
```

If you try to serialize the `TDigest` object directly, you will get instead:

```bash
Traceback (most recent call last):
  File "/home/kinow/Development/python/workspace/serialize-cython-pointers/serialize.py", line 25, in <module>
    main()
  File "/home/kinow/Development/python/workspace/serialize-cython-pointers/serialize.py", line 19, in main
    data = pickle.dumps(td)
ValueError: ctypes objects containing pointers cannot be pickled
```
